final List<Map<String, dynamic>> ingredientCategories = [
  {
    "name": "Vegetables",
    "ingredients": [
      "Artichoke", "Arugula", "Asparagus", "Bamboo Shoot", "Bean Sprout", "Beet",
      "Bell Pepper", "Bitter Gourd", "Bok Choy", "Broccoli", "Brussels Sprout",
      "Cabbage", "Calabash", "Capers", "Carrot", "Cauliflower", "Celery",
      "Chard", "Chayote", "Chicory", "Chinese Broccoli", "Collard Greens",
      "Cucumber", "Daikon", "Eggplant", "Endive", "Fennel", "Fiddlehead",
      "Garlic", "Ginger", "Green Bean", "Green Onion", "Horseradish", "Jalapeño",
      "Jerusalem Artichoke", "Jicama", "Kale", "Kohlrabi", "Leek", "Lettuce",
      "Lotus Root", "Mushroom", "Mustard Greens", "Napa Cabbage", "Okra", "Onion",
      "Parsnip", "Pea", "Pepper", "Pumpkin", "Purslane", "Radicchio",
      "Radish", "Rapini", "Red Cabbage", "Romanesco", "Rutabaga", "Savoy Cabbage",
      "Scallion", "Seaweed", "Shallot", "Snow Pea", "Sorrel", "Spinach", "Squash",
      "Swiss Chard", "Taro", "Tomato", "Turnip", "Water Chestnut",
      "Watercress", "Winter Melon", "Zucchini", "Acorn Squash", "Alfalfa Sprouts",
      "Amaranth Leaves", "Ancho Pepper", "Baby Corn", "Beetroot", "Belgian Endive",
      "Black Radish", "Broccolini", "Butternut Squash", "Cactus Pad", "Cardoon",
      "Celeriac", "Celery Root", "Chili Pepper", "Chinese Cabbage", "Chinese Celery",
      "Chinese Eggplant", "Cilantro Root", "Crookneck Squash", "Dandelion Greens",
      "Dasheen", "Delicata Squash", "Dill Pickle", "Dulse", "Edamame", "Elephant Garlic",
      "Escarole", "Fava Bean", "Field Pea", "Gai Lan", "Garlic Chives", "Gherkin",
      "Green Papaya", "Habanero Pepper", "Hakurei Turnip", "Hamburg Parsley", "Hearts of Palm",
      "Hubbard Squash", "Kabocha Squash", "Komatsuna", "Lamb's Lettuce", "Land Cress",
      "Lemon Cucumber", "Lemongrass", "Mache", "Malabar Spinach", "Mangetout",
      "Mizuna", "Morel Mushroom", "Mustard Spinach", "Nopales", "Oyster Mushroom",
      "Pak Choi", "Patty Pan Squash", "Pearl Onion", "Poblano Pepper", "Portobello Mushroom",
      "Pumpkin Seed", "Quandong", "Red Leaf Lettuce", "Red Onion", "Red Pepper",
      "Rocket", "Samphire", "Salsify", "Serrano Pepper", "Skirret", "Spaghetti Squash",
      "Sunflower Sprout", "Tomatillo", "Wasabi", "White Mushroom",
      "Wild Leek", "Yellow Onion", "Yellow Squash"
    ]
  },
  {
    "name": "Spices",
    "ingredients": [
      "Allspice", "Anise", "Annatto", "Asafoetida", "Basil", "Bay Leaf", "Black Cardamom",
      "Black Pepper", "Black Sesame", "Caraway", "Cardamom", "Cayenne", "Celery Seed",
      "Chervil", "Chicory", "Chili Flake", "Chili Powder", "Chinese Five-Spice",
      "Chives", "Cilantro", "Cinnamon", "Clove", "Coriander", "Cream of Tartar",
      "Cubeb Pepper", "Cumin", "Curry Leaf", "Curry Powder", "Dill", "Fennel Seed",
      "Fenugreek", "Galangal", "Garam Masala", "Garlic Powder", "Ginger Powder",
      "Grains of Paradise", "Horseradish", "Jamaican Allspice", "Juniper Berry",
      "Kaffir Lime Leaf", "Lavender", "Lemon Balm", "Lemongrass", "Licorice Root",
      "Long Pepper", "Mace", "Marjoram", "Mint", "Mustard Seed", "Nigella Seed",
      "Nutmeg", "Onion Powder", "Oregano", "Paprika", "Parsley", "Peppercorn",
      "Pink Peppercorn", "Poppy Seed", "Red Pepper Flake", "Rose Petal", "Rosemary",
      "Saffron", "Sage", "Salt", "Savory", "Sichuan Pepper", "Spearmint", "Star Anise",
      "Sumac", "Sweet Paprika", "Tamarind", "Tarragon", "Thyme", "Turmeric", "Vanilla Bean",
      "White Pepper", "Za'atar", "Adobo", "Aleppo Pepper", "Amchur", "Baharat",
      "Berbere", "Bouquet Garni", "Cajun Seasoning", "Caraway Seed", "Cassia Bark",
      "Celery Salt", "Ceylon Cinnamon", "Chamomile", "Chile de Arbol", "Chipotle",
      "Chive Blossom", "Citric Acid", "Coriander Seed", "Culantro", "Dehydrated Garlic",
      "Dehydrated Onion", "Dill Seed", "Dukkah", "Epazote", "File Powder", "Fingerroot",
      "Fines Herbes", "Fleur de Sel", "Galangal Powder", "Garlic Salt", "Green Cardamom",
      "Ground Cloves", "Ground Ginger", "Harissa", "Herbes de Provence", "Hibiscus",
      "Hot Paprika", "Italian Seasoning", "Jamaican Jerk Spice", "Jasmine", "Jimbu",
      "Kala Namak", "Kashmiri Chili", "Kosher Salt", "Lemon Pepper", "Lemon Verbena",
      "Lime Leaves", "Lovage", "Mango Powder", "Mexican Oregano", "Mint Leaf",
      "MSG", "Mustard Powder", "Old Bay Seasoning", "Onion Salt", "Oregano Leaf",
      "Pandan Leaf", "Perilla", "Pickling Spice", "Poultry Seasoning", "Pumpkin Pie Spice",
      "Ras el Hanout", "Red Pepper", "Sage Leaf", "Sazon", "Sea Salt", "Sesame Seed",
      "Shichimi Togarashi", "Smoked Paprika", "Taklia", "Thai Basil", "Thyme Leaf",
      "Truffle Salt", "Urfa Biber", "Vadouvan", "Vanilla Extract", "Vanilla Powder",
      "Wasabi Powder", "Whole Cloves", "Winter Savory"
    ]
  },
  {
    "name": "Main Ingredients",
    "ingredients": [
      // Grains
      "Rice", "Basmati Rice", "Jasmine Rice", "Brown Rice", "Wild Rice", "Arborio Rice",
      "Black Rice", "Red Rice", "Sushi Rice", "Glutinous Rice", "Quinoa", "Couscous",
      "Bulgur", "Barley", "Farro", "Millet", "Oats", "Polenta", "Cornmeal", "Grits",

      // Pasta & Noodles
      "Pasta", "Spaghetti", "Penne", "Fettuccine", "Linguine", "Lasagna", "Macaroni",
      "Farfalle", "Rigatoni", "Orzo", "Egg Noodles", "Rice Noodles", "Udon", "Soba",
      "Ramen", "Glass Noodles", "Vermicelli", "Whole Wheat Pasta", "Gnocchi",

      // Potatoes & Starchy Vegetables
      "Potato", "Sweet Potato", "Yam", "Cassava", "Plantain", "Corn", "Butternut Squash",
      "Acorn Squash", "Pumpkin", "Parsnip",

      // Proteins - Meat
      "Chicken", "Chicken Breast", "Chicken Thigh", "Chicken Drumstick", "Chicken Wing",
      "Ground Chicken", "Turkey", "Turkey Breast", "Ground Turkey", "Beef", "Ground Beef",
      "Beef Steak", "Beef Brisket", "Beef Ribs", "Pork", "Pork Chop", "Pork Tenderloin",
      "Pork Belly", "Ground Pork", "Bacon", "Ham", "Lamb", "Lamb Chop", "Lamb Leg",
      "Ground Lamb", "Duck", "Duck Breast", "Goose", "Rabbit", "Venison", "Bison",

      // Proteins - Seafood
      "Fish", "Salmon", "Tuna", "Cod", "Tilapia", "Trout", "Halibut", "Sea Bass",
      "Mackerel", "Snapper", "Sardine", "Anchovy", "Mahi Mahi", "Herring", "Catfish",
      "Shrimp", "Prawn", "Crab", "Lobster", "Scallop", "Mussel", "Clam", "Oyster",
      "Squid", "Octopus",

      // Proteins - Plant-based
      "Tofu", "Tempeh", "Seitan", "Edamame", "TVP", "Textured Vegetable Protein",
      "Beyond Meat", "Impossible Meat", "Plant-based Protein",

      // Legumes
      "Lentils", "Black Beans", "Kidney Beans", "Chickpeas", "Pinto Beans", "White Beans",
      "Navy Beans", "Lima Beans", "Black-eyed Peas", "Split Peas", "Adzuki Beans",
      "Cannellini Beans", "Great Northern Beans", "Fava Beans", "Mung Beans", "Soybeans"
    ]
  },
  {
    "name": "Others",
    "ingredients": [
      "Broth", "Chicken Broth", "Beef Broth", "Vegetable Broth", "Bone Broth",
      "Dashi", "Bouillon Cube", "Coconut Milk", "Coconut Cream", "Almond Milk",
      "Soy Milk", "Oat Milk", "Rice Milk", "Kombu", "Bonito Flakes", "Nutritional Yeast",
      "Dried Mushrooms", "Dried Seaweed", "Gelatin", "Agar Agar", "Bread Crumbs",
      "Panko", "Croutons", "Tortilla", "Pita Bread", "Naan", "Baguette", "Sourdough",
      "Wheat Bread", "Rye Bread", "Brioche", "Ciabatta", "Focaccia", "Flatbread",
      "Croissant", "Bagel", "English Muffin", "Crackers", "Water", "Sparkling Water",
      "Soda", "Fruit Juice", "Vegetable Juice", "Wine", "Beer", "Spirits", "Liqueur",
      "Coffee", "Tea", "Espresso", "Matcha", "Hot Chocolate", "Jam", "Jelly", "Preserves",
      "Marmalade", "Nutella", "Peanut Butter", "Almond Butter", "Cashew Butter",
      "Coconut Butter", "Dried Fruit", "Raisins", "Cranberries", "Dates", "Prunes",
      "Apricots", "Figs", "Protein Powder", "Baking Chips", "Sprinkles", "Food Coloring",
      "Xanthan Gum", "Guar Gum", "Lecithin", "Pectin", "Citric Acid", "Ascorbic Acid",
      "MSG", "Salt Substitute", "Cocktail Garnish", "Whipped Cream", "Ice Cream",
      "Sorbet", "Gelato", "Frozen Yogurt", "Mochi", "Chocolate Syrup", "Caramel Sauce",
      "Butterscotch Sauce", "Fruit Syrup", "Pickle Juice", "Whey", "Casein", "Protein Bar","Milk", "Whole Milk", "Skim Milk", "2% Milk", "Buttermilk", "Heavy Cream",
      "Half & Half", "Condensed Milk", "Evaporated Milk", "Butter", "Unsalted Butter",
      "Ghee", "Cheese", "Cheddar Cheese", "Mozzarella", "Parmesan", "Swiss Cheese",
      "Gouda", "Brie", "Feta", "Goat Cheese", "Cream Cheese", "Cottage Cheese",
      "Ricotta", "Blue Cheese", "Provolone", "Monterey Jack", "Mascarpone",
      "Yogurt", "Greek Yogurt", "Sour Cream", "Crème Fraîche", "Egg", "Egg White",
      "Egg Yolk", "Quail Egg", "Duck Egg", "Flour", "All-Purpose Flour", "Bread Flour", "Cake Flour", "Pastry Flour",
      "Whole Wheat Flour", "Almond Flour", "Coconut Flour", "Rice Flour", "Corn Flour",
      "Rye Flour", "Oat Flour", "Buckwheat Flour", "Semolina", "Cornstarch", "Tapioca Starch",
      "Potato Starch", "Arrowroot", "Baking Powder", "Baking Soda", "Yeast", "Sugar",
      "Brown Sugar", "Powdered Sugar", "Cane Sugar", "Granulated Sugar", "Honey", "Maple Syrup",
      "Agave Nectar", "Molasses", "Date Syrup", "Coconut Sugar", "Stevia", "Corn Syrup",
      "Chocolate", "Chocolate Chips", "Cocoa Powder", "White Chocolate", "Dark Chocolate",
      "Milk Chocolate", "Baking Chocolate", "Vanilla Extract", "Almond Extract", "Mint Extract", "Olive Oil", "Extra Virgin Olive Oil", "Vegetable Oil", "Canola Oil", "Coconut Oil",
      "Sesame Oil", "Peanut Oil", "Sunflower Oil", "Avocado Oil", "Grapeseed Oil",
      "Walnut Oil", "Flaxseed Oil", "Corn Oil", "Palm Oil", "Ghee", "Lard", "Shortening",
      "Vinegar", "Apple Cider Vinegar", "Balsamic Vinegar", "Red Wine Vinegar",
      "White Wine Vinegar", "Rice Vinegar", "Sherry Vinegar", "Malt Vinegar", "Champagne Vinegar", "Almond", "Cashew", "Walnut", "Pecan", "Pistachio", "Hazelnut", "Macadamia",
      "Pine Nut", "Brazil Nut", "Peanut", "Chestnut", "Sunflower Seed", "Pumpkin Seed",
      "Sesame Seed", "Flaxseed", "Chia Seed", "Hemp Seed", "Poppy Seed", "Fennel Seed","Ketchup", "Mustard", "Mayonnaise", "Hot Sauce", "Soy Sauce", "Tamari",
      "Fish Sauce", "Worcestershire Sauce", "Teriyaki Sauce", "BBQ Sauce", "Sriracha",
      "Tabasco", "Hoisin Sauce", "Oyster Sauce", "Miso Paste", "Tahini", "Pesto",
      "Salsa", "Hummus", "Harissa", "Chimichurri", "Aioli", "Tzatziki", "Guacamole",
      "Sambal", "Gochujang", "Doubanjiang", "Mirin", "Rice Wine", "Cooking Wine",
      "Tomato Paste", "Tomato Sauce", "Tomato Puree", "Chili Oil", "Pickle", "Relish",
      "Capers", "Olives", "Sun-dried Tomatoes", "Anchovy Paste", "Honey Mustard",
      "Dijon Mustard", "Whole Grain Mustard", "Yellow Mustard","Apple", "Apricot", "Avocado", "Banana", "Blackberry", "Blueberry", "Cantaloupe",
      "Cherry", "Clementine", "Coconut", "Cranberry", "Date", "Dragon Fruit", "Fig",
      "Grape", "Grapefruit", "Guava", "Honeydew", "Kiwi", "Kumquat", "Lemon", "Lime",
      "Lychee", "Mandarin", "Mango", "Melon", "Mulberry", "Nectarine", "Orange",
      "Papaya", "Passion Fruit", "Peach", "Pear", "Persimmon", "Pineapple", "Plum",
      "Pomegranate", "Quince", "Raspberry", "Red Currant", "Rhubarb", "Starfruit",
      "Strawberry", "Tangerine", "Watermelon", "Acai Berry", "Acerola Cherry",
      "Ackee", "Banana Passionfruit", "Barbados Cherry", "Bearberry", "Bilberry",
      "Black Currant", "Black Raspberry", "Black Sapote", "Blood Orange", "Boysenberry",
      "Breadfruit", "Cacao", "Calamansi", "Calamondin", "Cape Gooseberry", "Carambola",
      "Casaba Melon", "Cherimoya", "Chinese Bayberry", "Cloudberry", "Crab Apple",
      "Currant", "Custard Apple", "Damson", "Durian", "Elderberry", "Feijoa",
      "Finger Lime", "Goji Berry", "Gooseberry", "Grenadilla", "Hala Fruit",
      "Honeycrisp Apple", "Huckleberry", "Jabuticaba", "Jackfruit", "Jambolan",
      "Japanese Plum", "Java Apple", "Jujube", "Kaffir Lime", "Key Lime", "Kiwano",
      "Langsat", "Longan", "Loquat", "Lulo", "Mamey Sapote", "Mangosteen", "Maracuya",
      "Maraschino Cherry", "Marionberry", "Medlar", "Meyer Lemon", "Miracle Fruit",
      "Monstera Deliciosa", "Muscadine Grape", "Nance", "Persian Lime", "Physalis",
      "Prickly Pear", "Rambutan", "Rangpur", "Salak", "Santol", "Sapodilla",
      "Saskatoon Berry", "Satsuma", "Soursop", "Sugar Apple", "Surinam Cherry",
      "Tamarillo", "Tamarind", "Tangelo", "Tayberry", "Ugli Fruit", "White Currant",
      "White Sapote", "Yuzu"
    ]
  }
];

final List<String> allIngredients = ingredientCategories
    .expand((category) => category["ingredients"] as List<dynamic>)
    .cast<String>()
    .toList()
  ..sort();



String getCategoryForIngredient(String ingredient) {
  // Die übergebene 'ingredient' ist bereits kleingeschrieben durch _addIngredient
  // final String lowerIngredient = ingredient.toLowerCase(); // Nicht mehr nötig, da schon klein

  for (final category in ingredientCategories) {
    // Stelle sicher, dass die Listenelemente Strings sind und konvertiere sie für den Vergleich zu Kleinbuchstaben
    final ingredients = category["ingredients"] as List<dynamic>;

    // *** KORREKTUR HIER: ***
    // Erstelle eine temporäre Liste mit kleingeschriebenen Zutaten für den Vergleich
    if (ingredients.map((e) => e.toString().toLowerCase()).contains(ingredient)) {
      // Vergleicht jetzt z.B. "tomato" mit ["onion", "tomato", "carrot", ...] -> ergibt true!
      return category["name"] as String;
    }
  }
  // Wenn in keiner der spezifischen Kategorien gefunden
  return "Others";
}

//Hallo test